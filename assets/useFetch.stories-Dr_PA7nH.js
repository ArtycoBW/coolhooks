import{j as r}from"./jsx-runtime-DWbWqHZ-.js";import{r as t}from"./index-l2PZgWEW.js";const S="_wrapper_1rxhq_1",$="_info_1rxhq_13",k="_email_1rxhq_19",n={wrapper:S,info:$,email:k};function R(s,c){const i=t.useRef({}),[p,e]=t.useState(!1),[m,o]=t.useState(null),[D,b]=t.useState(null),[u,E]=t.useState(s),l=t.useRef(null),h=t.useCallback(async()=>{l.current&&l.current.abort(),l.current=new AbortController;const C=5*60*1e3,d=i.current[u];if(d&&Date.now()-d.timestamp<C){o(d.data),e(!1);return}try{e(!0);const a=await fetch(u,{...c,signal:l.current.signal});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const x=await a.json();i.current[u]={data:x,timestamp:Date.now()},o(x)}catch(a){a instanceof Error&&a.name!=="AbortError"&&b(a)}finally{e(!1),l.current=null}},[u,c]),N=t.useCallback(()=>{E(`${s}?timestamp=${new Date().getTime()}`)},[s]);return t.useEffect(()=>{h()},[h]),{data:m,error:D,loading:p,refetch:N}}const g=()=>{const{data:s,error:c,loading:i,refetch:p}=R("https://randomuser.me/api/");if(i)return r.jsx("div",{className:n.wrapper,children:r.jsx("p",{className:n.info,children:"Загрузка..."})});if(c)return r.jsx("div",{className:n.wrapper,children:r.jsxs("p",{className:n.info,children:["Ошибка: ",c.message]})});const{name:e,email:m,picture:o}=(s==null?void 0:s.results[0])??{};return r.jsxs("div",{className:n.wrapper,children:[r.jsx("img",{src:o==null?void 0:o.large,alt:`${e==null?void 0:e.first} ${e==null?void 0:e.last}`}),r.jsxs("h1",{className:n.info,children:[e==null?void 0:e.first," ",e==null?void 0:e.last]}),r.jsx("p",{className:n.email,children:m}),r.jsx("button",{onClick:p,children:"Обновить данные"})]})},y={title:"Хуки/useFetch",component:g},T=()=>r.jsx(g,{}),f=T.bind({});var w,j,_;f.parameters={...f.parameters,docs:{...(w=f.parameters)==null?void 0:w.docs,source:{originalSource:"() => <Demo />",...(_=(j=f.parameters)==null?void 0:j.docs)==null?void 0:_.source}}};const F=["Default"];export{f as Default,F as __namedExportsOrder,y as default};
